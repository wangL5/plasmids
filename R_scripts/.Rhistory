#| echo: false
library(ggplot2)
f1_score_boxplot <- ggplot(per_contig_data, aes(x = classifier, y = f1_score, fill = assembler)) + geom_boxplot(position = position_dodge(width=0.8)) +
scale_fill_manual(values=c("orange", "cornflowerblue")) +
theme_minimal(base_size = 14) +
labs(title = "F1 Score by Classifier and Assembler", x = "", y = "", fill = "",
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5),
panel.grid.major.x = element_blank()
) +
x_axis_discrete=c("DeepMicroClass", "geNomad", "MobRecon", "PlasClass", "PLASMe", "Plasmidfinder", "PlasX 0.5", "PlasxX 0.75", "Plasx 0.9", "Platon", "viralVerify")
#| echo: false
library(ggplot2)
f1_score_boxplot <- ggplot(per_contig_data, aes(x = classifier, y = f1_score, fill = assembler)) + geom_boxplot(position = position_dodge(width=0.8)) +
scale_fill_manual(values=c("orange", "cornflowerblue")) +
theme_minimal(base_size = 14) +
labs(title = "F1 Score by Classifier and Assembler", x = "", y = "", fill = "",
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5),
panel.grid.major.x = element_blank()
) +
scale_x_discrete(labels = c("DeepMicroClass", "geNomad", "MobRecon", "PlasClass", "PLASMe", "Plasmidfinder", "PlasX 0.5", "PlasxX 0.75", "Plasx 0.9", "Platon", "viralVerify"))
plot(f1_score_boxplot)
#| echo: false
library(ggplot2)
f1_score_boxplot <- ggplot(per_contig_data, aes(x = classifier, y = f1_score, fill = assembler)) + geom_boxplot(position = position_dodge(width=0.8)) +
scale_fill_manual(values=c("orange", "cornflowerblue"), labels = c("megahit", "metaplasmidSPAdes")) +
theme_minimal(base_size = 14) +
labs(title = "F1 Score by Classifier and Assembler", x = "", y = "", fill = "",
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5),
panel.grid.major.x = element_blank()
) +
scale_x_discrete(labels = c("DeepMicroClass", "geNomad", "MobRecon", "PlasClass", "PLASMe", "Plasmidfinder", "PlasX (0.5)", "PlasxX (0.75)", "Plasx (0.9)", "Platon", "viralVerify"))
plot(f1_score_boxplot)
#| echo: false
library(ggplot2)
f1_score_boxplot <- ggplot(per_contig_data, aes(x = classifier, y = f1_score, fill = assembler)) + geom_boxplot(position = position_dodge(width=0.8)) +
scale_fill_manual(values=c("orange", "cornflowerblue"), labels = c("megahit", "metaplasmidSPAdes")) +
theme_minimal(base_size = 14) +
labs(title = "F1 Score by Classifier and Assembler", x = "", y = "", fill = "",
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5),
panel.grid.major.x = element_blank(),
legend.position="bottom"
) +
scale_x_discrete(labels = c("DeepMicroClass", "geNomad", "MobRecon", "PlasClass", "PLASMe", "Plasmidfinder", "PlasX (0.5)", "PlasxX (0.75)", "Plasx (0.9)", "Platon", "viralVerify"))
plot(f1_score_boxplot)
#| echo: false
library(ggplot2)
f1_score_boxplot <- ggplot(per_contig_data, aes(x = classifier, y = f1_score, fill = assembler)) + geom_boxplot(position = position_dodge(width=0.8)) +
scale_fill_manual(values=c("orange", "cornflowerblue"), labels = c("megahit", "metaplasmidSPAdes")) +
theme_minimal(base_size = 14) +
labs(title = "CAMI2 Plasmid Benchmarking: F1 Score by Classifier and Assembler", x = "", y = "", fill = "",
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5),
panel.grid.major.x = element_blank(),
legend.position="bottom"
) +
scale_x_discrete(labels = c("DeepMicroClass", "geNomad", "MobRecon", "PlasClass", "PLASMe", "Plasmidfinder", "PlasX (0.5)", "PlasxX (0.75)", "Plasx (0.9)", "Platon", "viralVerify"))
plot(f1_score_boxplot)
#| echo: False
# CAMI2 Precision-Recall Figure
library(ggplot2)
library(dplyr)
library(pals)
CAMI2_PR_curve <- ggplot(per_contig_data, aes(x = recall, y = precision, color = classifier)) + scale_color_manual(values=unname(alphabet())) +
geom_point(alpha = 0.7, size = 2) +
facet_wrap(~ assembler) +
labs(
title = "Precision vs Recall by Assembler and Classifier",
x = "Recall",
y = "Precision",
color = "Classifier"
) +
theme_minimal() +
theme(
strip.text = element_text(face = "bold"),
legend.position = "bottom",
plot.title = element_text(hjust=0.5)
)
plot(CAMI2_PR_curve)
#| echo: False
# CAMI2 Precision-Recall Figure
library(ggplot2)
library(dplyr)
library(pals)
CAMI2_PR_curve <- ggplot(per_contig_data, aes(x = recall, y = precision, color = classifier)) + scale_color_manual(values=unname(alphabet()), labels = c("DeepMicroClass", "geNomad", "MobRecon", "PlasClass", "PLASMe", "Plasmidfinder", "PlasX (0.5)", "PlasxX (0.75)", "Plasx (0.9)", "Platon", "viralVerify")) +
geom_point(alpha = 0.7, size = 2) +
facet_wrap(~ assembler, labeller = as_labeller(c("megahit", "metaplasmidSPAdes"))) +
labs(
title = "Precision vs Recall by Assembler and Classifier",
x = "Recall",
y = "Precision",
color = "Classifier"
) +
theme_minimal() +
theme(
strip.text = element_text(face = "bold"),
legend.position = "bottom",
plot.title = element_text(hjust=0.5)
)
plot(CAMI2_PR_curve)
#| echo: False
# CAMI2 Precision-Recall Figure
library(ggplot2)
library(dplyr)
library(pals)
CAMI2_PR_curve <- ggplot(per_contig_data, aes(x = recall, y = precision, color = classifier)) + scale_color_manual(values=unname(alphabet()), labels = c("DeepMicroClass", "geNomad", "MobRecon", "PlasClass", "PLASMe", "Plasmidfinder", "PlasX (0.5)", "PlasxX (0.75)", "Plasx (0.9)", "Platon", "viralVerify")) +
geom_point(alpha = 0.7, size = 2) +
facet_wrap(~ assembler, labeller = as_labeller(c("mpspades" = "metaplasmidSPAdes"))) +
labs(
title = "Precision vs Recall by Assembler and Classifier",
x = "Recall",
y = "Precision",
color = "Classifier"
) +
theme_minimal() +
theme(
strip.text = element_text(face = "bold"),
legend.position = "bottom",
plot.title = element_text(hjust=0.5)
)
plot(CAMI2_PR_curve)
#| echo: False
# CAMI2 Precision-Recall Figure
library(ggplot2)
library(dplyr)
library(pals)
CAMI2_PR_curve <- ggplot(per_contig_data, aes(x = recall, y = precision, color = classifier)) + scale_color_manual(values=unname(alphabet()), labels = c("DeepMicroClass", "geNomad", "MobRecon", "PlasClass", "PLASMe", "Plasmidfinder", "PlasX (0.5)", "PlasxX (0.75)", "Plasx (0.9)", "Platon", "viralVerify")) +
geom_point(alpha = 0.7, size = 2) +
facet_wrap(~ assembler, labeller = as_labeller(c("mpspades" = "metaplasmidSPAdes"))) +
labs(
title = "Precision vs Recall by Assembler and Classifier",
x = "Recall",
y = "Precision",
color = "Classifier"
) +
theme_minimal() +
theme(
strip.text = element_text(face = "bold"),
legend.position = "bottom",
plot.title = element_text(hjust=0.5)
)
plot(CAMI2_PR_curve)
#| echo: False
# CAMI2 Precision-Recall Figure
library(ggplot2)
library(dplyr)
library(pals)
CAMI2_PR_curve <- ggplot(per_contig_data, aes(x = recall, y = precision, color = classifier)) + scale_color_manual(values=unname(alphabet()), labels = c("DeepMicroClass", "geNomad", "MobRecon", "PlasClass", "PLASMe", "Plasmidfinder", "PlasX (0.5)", "PlasxX (0.75)", "Plasx (0.9)", "Platon", "viralVerify")) +
geom_point(alpha = 0.7, size = 2) +
facet_wrap(~ assembler) +
labs(
title = "Precision vs Recall by Assembler and Classifier",
x = "Recall",
y = "Precision",
color = "Classifier"
) +
theme_minimal() +
theme(
strip.text = element_text(face = "bold"),
legend.position = "bottom",
plot.title = element_text(hjust=0.5)
)
plot(CAMI2_PR_curve)
#| echo: False
# CAMI2 Precision-Recall Figure
library(ggplot2)
library(dplyr)
library(pals)
CAMI2_PR_curve <- ggplot(per_contig_data, aes(x = recall, y = precision, color = classifier)) + scale_color_manual(values=unname(alphabet()), labels = c("DeepMicroClass", "geNomad", "MobRecon", "PlasClass", "PLASMe", "Plasmidfinder", "PlasX (0.5)", "PlasxX (0.75)", "Plasx (0.9)", "Platon", "viralVerify")) +
geom_point(alpha = 0.7, size = 2) +
facet_wrap(~ assembler, labeller = as_labeller(c("mpSPAdes" = "metaplasmidSPAdes"))) +
labs(
title = "Precision vs Recall by Assembler and Classifier",
x = "Recall",
y = "Precision",
color = "Classifier"
) +
theme_minimal() +
theme(
strip.text = element_text(face = "bold"),
legend.position = "bottom",
plot.title = element_text(hjust=0.5)
)
plot(CAMI2_PR_curve)
#| echo: False
# CAMI2 Precision-Recall Figure
library(ggplot2)
library(dplyr)
library(pals)
CAMI2_PR_curve <- ggplot(per_contig_data, aes(x = recall, y = precision, color = classifier)) + scale_color_manual(values=unname(alphabet()), labels = c("DeepMicroClass", "geNomad", "MobRecon", "PlasClass", "PLASMe", "Plasmidfinder", "PlasX (0.5)", "PlasxX (0.75)", "Plasx (0.9)", "Platon", "viralVerify")) +
geom_point(alpha = 0.7, size = 2) +
facet_wrap(~ assembler, labeller = as_labeller(c("mpSPAdes" = "metaplasmidSPAdes", "megahit" = "megahit"))) +
labs(
title = "Precision vs Recall by Assembler and Classifier",
x = "Recall",
y = "Precision",
color = "Classifier"
) +
theme_minimal() +
theme(
strip.text = element_text(face = "bold"),
legend.position = "bottom",
plot.title = element_text(hjust=0.5)
)
plot(CAMI2_PR_curve)
#| echo: false
library(ggplot2)
#clean_labels = c("DeepMicroClass", "geNomad", "MobRecon", "PlasClass", "PLASMe", "Plasmidfinder", "PlasX (0.5)", "PlasxX (0.75)", "Plasx (0.9)", "Platon", "viralVerify")
f1_score_boxplot <- ggplot(per_contig_data, aes(x = classifier, y = f1_score, fill = assembler)) + geom_boxplot(position = position_dodge(width=0.8)) +
scale_fill_manual(values=c("orange", "cornflowerblue"), labels = c("megahit", "metaplasmidSPAdes")) +
theme_minimal(base_size = 14) +
labs(title = "CAMI2 Plasmid Benchmarking: F1 Score by Classifier and Assembler", x = "", y = "", fill = "",
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5),
panel.grid.major.x = element_blank(),
legend.position="bottom"
)
plot(f1_score_boxplot)
#| echo: false
library(ggplot2)
clean_labels = c("DMC" = "DeepMicroClass", "genomad" = "geNomad", "mobrecon" = "MobRecon", "plasclass" = "PlasClass", "plasme" = "PLASMe", "plasmidfinder" = "Plasmidfinder", "plasx05" = "PlasX (0.5)", "plasx075" = "PlasxX (0.75)", "plasx09" = "Plasx (0.9)", "platon" = "Platon", "vv" = "viralVerify")
f1_score_boxplot <- ggplot(per_contig_data, aes(x = classifier, y = f1_score, fill = assembler)) + geom_boxplot(position = position_dodge(width=0.8)) +
scale_fill_manual(values=c("orange", "cornflowerblue"), labels = c("megahit", "metaplasmidSPAdes")) +
theme_minimal(base_size = 14) +
labs(title = "CAMI2 Plasmid Benchmarking: F1 Score by Classifier and Assembler", x = "", y = "", fill = "",
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5),
panel.grid.major.x = element_blank(),
legend.position="bottom"
) +
scale_x_discrete(clean_labels)
plot(f1_score_boxplot)
#| echo: false
library(ggplot2)
clean_labels = c("DMC" = "DeepMicroClass", "genomad" = "geNomad", "mobrecon" = "MobRecon", "plasclass" = "PlasClass", "plasme" = "PLASMe", "plasmidfinder" = "Plasmidfinder", "plasx05" = "PlasX (0.5)", "plasx075" = "PlasxX (0.75)", "plasx09" = "Plasx (0.9)", "platon" = "Platon", "vv" = "viralVerify")
f1_score_boxplot <- ggplot(per_contig_data, aes(x = classifier, y = f1_score, fill = assembler)) + geom_boxplot(position = position_dodge(width=0.8)) +
scale_fill_manual(values=c("orange", "cornflowerblue"), labels = c("megahit", "metaplasmidSPAdes")) +
theme_minimal(base_size = 14) +
labs(title = "CAMI2 Plasmid Benchmarking: F1 Score by Classifier and Assembler", x = "", y = "", fill = "",
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5),
panel.grid.major.x = element_blank(),
legend.position="bottom"
) +
scale_x_discrete(labels = clean_labels)
plot(f1_score_boxplot)
#| echo: False
# CAMI2 Precision-Recall Figure
library(ggplot2)
library(dplyr)
library(pals)
CAMI2_PR_curve <- ggplot(per_contig_data, aes(x = recall, y = precision, color = classifier)) + scale_color_manual(values=unname(alphabet()), labels = clean_labels) +
# clean_labels defined above in F1 boxplot
geom_point(alpha = 0.7, size = 2) +
facet_wrap(~ assembler, labeller = as_labeller(c("mpSPAdes" = "metaplasmidSPAdes", "megahit" = "megahit"))) +
labs(
title = "Precision vs Recall by Assembler and Classifier",
x = "Recall",
y = "Precision",
color = "Classifier"
) +
theme_minimal() +
theme(
strip.text = element_text(face = "bold"),
legend.position = "bottom",
plot.title = element_text(hjust=0.5)
)
plot(CAMI2_PR_curve)
View(mapping_data_transformed)
View(per_contig_data)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
library(pals)
CAMI2_benchmarking_metrics_TP_contigs <- read.table("CAMI2_benchmarking_metrics_TPcontigs.tsv.txt", sep="\t", header=TRUE)
#| echo: false
library(pheatmap)
library(RColorBrewer)
#| echo: false
annotation_colors <- list(contig_length = colorRampPalette(brewer.pal(3,'PuBu'))(100),
coverage = colorRampPalette(brewer.pal(3, 'Spectral'))(100))
pheatmap(mpspades_data,
main = "Metaplasmidspades Plasmid Reference Detection Rates (%)",
show_rownames = FALSE,
color = colorRampPalette(brewer.pal(3, 'RdYlBu'))(100),
annotation_row = filtered_plasmid_CE_annotations,
annotation_names_row = F)
#| echo: false
annotation_colors <- list(contig_length = colorRampPalette(brewer.pal(3,'PuBu'))(100),
coverage = colorRampPalette(brewer.pal(3, 'Spectral'))(100))
pheatmap(mpspades_data,
main = "Metaplasmidspades Plasmid Reference Detection Rates (%)",
show_rownames = FALSE,
color = colorRampPalette(brewer.pal(3, 'RdYlBu'))(100),
# annotation_row = filtered_plasmid_CE_annotations,
#annotation_names_row = F)
#| echo: false
annotation_colors <- list(contig_length = colorRampPalette(brewer.pal(3,'PuBu'))(100),
coverage = colorRampPalette(brewer.pal(3, 'Spectral'))(100))
pheatmap(mpspades_data,
main = "Metaplasmidspades Plasmid Reference Detection Rates (%)",
show_rownames = FALSE,
color = colorRampPalette(brewer.pal(3, 'RdYlBu'))(100))
# annotation_row = filtered_plasmid_CE_annotations,
#annotation_names_row = F)
View(per_contig_data)
#| echo: false
pheatmap(megahit_data,
main = "Megahit Plasmid Reference Detection Rates (%)",
show_rownames = FALSE,
color = colorRampPalette(brewer.pal(3, 'RdYlBu'))(100))
#annotation_row = filtered_plasmid_CE_annotations,
#annotation_names_row = F)
#| echo: false
library(ggplot2)
clean_labels = c("DMC" = "DeepMicroClass", "genomad" = "geNomad", "mobrecon" = "MobRecon", "plasclass" = "PlasClass", "plasme" = "PLASMe", "plasmidfinder" = "Plasmidfinder", "plasx05" = "PlasX (0.5)", "plasx075" = "PlasxX (0.75)", "plasx09" = "Plasx (0.9)", "platon" = "Platon", "vv" = "viralVerify")
f1_score_boxplot <- ggplot(per_contig_data, aes(x = classifier, y = f1_score, fill = assembler)) + geom_boxplot(position = position_dodge(width=0.8)) +
scale_fill_manual(values=c("orange", "cornflowerblue"), labels = c("megahit", "metaplasmidSPAdes")) +
theme_minimal(base_size = 14) +
labs(title = "CAMI2 Plasmid Benchmarking: F1 Score by Classifier and Assembler", x = "", y = "", fill = "",
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5),
panel.grid.major.x = element_blank(),
legend.position="bottom"
) +
scale_x_discrete(labels = clean_labels)
plot(f1_score_boxplot)
#| echo: false
# renaming the matrix columns
colnames(mpspades_data) <- clean_labels[colnames(mpspades_data)]
colnames(megahit_data) <- clean_labels[colnames(megahit_data)]
#| echo: false
annotation_colors <- list(contig_length = colorRampPalette(brewer.pal(3,'PuBu'))(100),
coverage = colorRampPalette(brewer.pal(3, 'Spectral'))(100))
pheatmap(mpspades_data,
main = "MetaplasmidSPAdes Plasmid Reference Detection Rates (%)",
show_rownames = FALSE,
color = colorRampPalette(brewer.pal(3, 'RdYlBu'))(100))
# annotation_row = filtered_plasmid_CE_annotations,
#annotation_names_row = F)
#| echo: false
# renaming the matrix columns
colnames(mpspades_data) <- clean_labels[colnames(mpspades_data)]
colnames(megahit_data) <- clean_labels[colnames(megahit_data)]
#| echo: false
library(ggplot2)
clean_labels = c("DMC" = "DeepMicroClass", "genomad" = "geNomad", "mobrecon" = "MobRecon", "plasclass" = "PlasClass", "plasme" = "PLASMe", "plasmidfinder" = "Plasmidfinder", "plasx05" = "PlasX (0.5)", "plasx075" = "PlasxX (0.75)", "plasx09" = "Plasx (0.9)", "platon" = "Platon", "vv" = "viralVerify")
f1_score_boxplot <- ggplot(per_contig_data, aes(x = classifier, y = f1_score, fill = assembler)) + geom_boxplot(position = position_dodge(width=0.8)) +
scale_fill_manual(values=c("orange", "cornflowerblue"), labels = c("megahit", "metaplasmidSPAdes")) +
theme_minimal(base_size = 14) +
labs(title = "CAMI2 Plasmid Benchmarking: F1 Score by Classifier and Assembler", x = "", y = "", fill = "",
) +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5),
panel.grid.major.x = element_blank(),
legend.position="bottom"
) +
scale_x_discrete(labels = clean_labels)
plot(f1_score_boxplot)
#| echo: false
# read in data
mpspades_data <- read.csv("mpspades_heatmap.csv", row.names = 1)
megahit_data <- read.csv("megahit_heatmap.csv", row.names=1)
#| echo: false
# renaming the matrix columns
colnames(mpspades_data) <- clean_labels[colnames(mpspades_data)]
colnames(megahit_data) <- clean_labels[colnames(megahit_data)]
#| echo: false
library(pheatmap)
library(RColorBrewer)
#| echo: false
annotation_colors <- list(contig_length = colorRampPalette(brewer.pal(3,'PuBu'))(100),
coverage = colorRampPalette(brewer.pal(3, 'Spectral'))(100))
pheatmap(mpspades_data,
main = "MetaplasmidSPAdes Plasmid Reference Detection Rates (%)",
show_rownames = FALSE,
color = colorRampPalette(brewer.pal(3, 'RdYlBu'))(100))
# annotation_row = filtered_plasmid_CE_annotations,
#annotation_names_row = F)
#| echo: false
pheatmap(megahit_data,
main = "Megahit Plasmid Reference Detection Rates (%)",
show_rownames = FALSE,
color = colorRampPalette(brewer.pal(3, 'RdYlBu'))(100))
#annotation_row = filtered_plasmid_CE_annotations,
#annotation_names_row = F)
View(megahit_data)
#| echo: false
# read in data
mpspades_data <- read.csv("mpspades_heatmap.csv", row.names = 1)
megahit_data <- read.csv("megahit_heatmap.csv", row.names=1)
View(megahit_data)
View(mpspades_data)
View(megahit_data)
mpspades_data <- read.csv("mpspades_heatmap.csv", row.names = 1)
megahit_data <- read.csv("megahit_heatmap.csv", row.names=1)
# read in metadata
plasmid_CE_annotations <- read.csv("plasmid_CE_metadata.txt", row.names=1, sep="\t")
#| echo: false
# read in data
mpspades_data <- read.csv("mpspades_heatmap.csv", row.names = 1)
megahit_data <- read.csv("megahit_heatmap.csv", row.names=1)
#| echo: false
# renaming the matrix columns
colnames(mpspades_data) <- clean_labels[colnames(mpspades_data)]
colnames(megahit_data) <- clean_labels[colnames(megahit_data)]
#| echo: false
library(pheatmap)
library(RColorBrewer)
#| echo: false
annotation_colors <- list(contig_length = colorRampPalette(brewer.pal(3,'PuBu'))(100),
coverage = colorRampPalette(brewer.pal(3, 'Spectral'))(100))
pheatmap(mpspades_data,
main = "MetaplasmidSPAdes Plasmid Reference Detection Rates (%)",
show_rownames = FALSE,
color = colorRampPalette(brewer.pal(3, 'RdYlBu'))(100))
# annotation_row = filtered_plasmid_CE_annotations,
#annotation_names_row = F)
#| echo: false
pheatmap(megahit_data,
main = "Megahit Plasmid Reference Detection Rates (%)",
show_rownames = FALSE,
color = colorRampPalette(brewer.pal(3, 'RdYlBu'))(100))
#annotation_row = filtered_plasmid_CE_annotations,
#annotation_names_row = F)
#| echo: false
gene_fam_metadata = read.csv("gene_fams_metadata.txt", sep="\t")
View(gene_fam_metadata)
#| echo: false
library(dplyr)
#| echo: false
mpspades_genefam_matrix = table(gene_fam_metadata$accession, gene_fam_metadata$mpspades_detection)
megahit_genefam_matrix = table(gene_fam_metadata$accession, gene_fam_metadata$megahit_detection)
View(megahit_data)
View(mpspades_data)
View(megahit_genefam_matrix)
View(mpspades_genefam_matrix)
#| echo: false
mpspades_genefam_matrix = table(gene_fam_metadata$mpspades_detection, gene_fam_metadata$accession)
megahit_genefam_matrix = table(gene_fam_metadata$megahit_detection, gene_fam_metadata$accession)
head(mpspades_genefam_matrix)
rownames(mpspades_genefam_matrix)
colnames(mpspades_genefam_matrix)
View(mpspades_genefam_matrix)
print(mpspades_genefam_matrix[1,]
print(mpspades_genefam_matrix[1,])
unique(gene_fam_metadata$mpspades_detection)
unique(gene_fam_metadata$megahit_detection)
unique(gene_fam_metadata$accession)
rownames(megahit_genefam_matrix)
colnames(megahit_genefam_matrix)
#| echo: false
filtered_mpspades_gene_fam = gene_fam_metadata[gene_fam_metadata$mpspades_detection ~= "", ]
#| echo: false
filtered_mpspades_gene_fam = gene_fam_metadata[gene_fam_metadata$mpspades_detection != "", ]
mpspades_genefam_matrix = table(gene_fam_metadata$mpspades_detection, gene_fam_metadata$accession)
rownames(mpspades_genefam_matrix)
#| echo: false
filtered_mpspades_gene_fam = gene_fam_metadata[gene_fam_metadata$mpspades_detection != "", ]
mpspades_genefam_matrix = table(filtered_mpspades_gene_fam$mpspades_detection, filtered_mpspades_gene_fam$accession)
rownames(mpspades_genefam_matrix)
mpspades_genefam_matrix
chisq.test(mpspades_genefam_matrix)
chisq.test(megahit_genefam_matrix)
chisq.test(megahit_genefam_matrix, simulate.p.value = TRUE)
chisq.test(mpspades_genefam_matrix, simulate.p.value = TRUE)
# warning that the chi-squared approximate may be incorrect, due to the assumptions for using chi squared distributions: small expected cell frequencies in the contingency table
chisq.test(mpspades_genefam_matrix, simulate.p.value = TRUE, B=99999)
# warning that the chi-squared approximate may be incorrect, due to the assumptions for using chi squared distributions: small expected cell frequencies in the contingency table
chisq.test(megahit_genefam_matrix, simulate.p.value = TRUE, B = 99999)
fisher.test(mpspades_genefam_matrix)
fisher.test(mpspades_genefam_matrix. workspace=2e7
fisher.test(mpspades_genefam_matrix, workspace=2e7
fisher.test(mpspades_genefam_matrix, workspace=2e7)
fisher.test(mpspades_genefam_matrix, simulate.p.value = T)
fisher.test(megahit_genefam_matrix, simulate.p.value=T)
View(gene_fam_metadata)
gene_fam_metadata = read_csv("gene_fams_metadata.txt", sep="\t")
gene_fam_metadata = read.csv("gene_fams_metadata.txt", sep="\t")
View(gene_fam_metadata)
